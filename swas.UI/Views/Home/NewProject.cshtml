@using swas.BAL.DTO;
@using swas.DAL.Models
@using swas.BAL.Helpers
@model UnitValidate
@inject IHttpContextAccessor HttpContextAccessor

@{
    ViewData["Title"] = "Software Whitelisting Autoation Software";
    int sno = 0;
    Layout = "";
    var username = ViewBag.LoggedInUserName;
    var ip = ViewBag.ipadd;
    var flag = ViewBag.flag;

    var ButtonText = ViewBag.ButtonText;

    var role = ViewBag.userRole;
    var newproject = ViewBag.RecentAction;
    var WhiteListed = ViewBag.WhiteListed;
    var Holdproj = ViewBag.HoldProj;
    var corse = ViewBag.Courses;
    var stage = ViewBag.RFPProj;
    Login Logins = SessionHelper.GetObjectFromJson<Login>(HttpContextAccessor.HttpContext.Session, "User");


}

<head>
    <link href="~/css/newpage.css" rel="stylesheet" />

    <link href="~/assets/css/bootstrap.min.css" rel="stylesheet">
    <script src="~/assets/js/bootstrap.min.js"></script>

    <link href="~/assets/css/font-awesome/fonts/font-awesome.min.css" rel="stylesheet" />
    <script language="JavaScript" type="text/javascript" src="~/assets/js/jquery.min.js"></script>
    <script language="JavaScript" type="text/javascript" src="~/assets/js/main.js"></script>
    <script language="JavaScript" type="text/javascript" src="~/assets/dataTable/js/jquery.dataTables.min.js"></script>
    <script language="JavaScript" type="text/javascript" src="~/assets/dataTable/js/dataTables.bootstrap4.min.js"></script>
    <script language="JavaScript" type="text/javascript" src="~/assets/dataTable/js/dataTables.buttons.min.js"></script>
    <script language="JavaScript" type="text/javascript" src="~/assets/dataTable/js/buttons.bootstrap4.min.js"></script>
    <script language="JavaScript" type="text/javascript" src="~/assets/dataTable/js/jszip.min.js"></script>
    <script language="JavaScript" type="text/javascript" src="~/assets/dataTable/js/vfs_fonts.js"></script>
    <script language="JavaScript" type="text/javascript" src="~/assets/dataTable/js/buttons.html5.min.js"></script>
    <script language="JavaScript" type="text/javascript" src="~/assets/dataTable/js/buttons.print.min.js"></script>
    <script language="JavaScript" type="text/javascript" src="~/assets/dataTable/js/buttons.colVis.min.js"></script>
    <script language="JavaScript" type="text/javascript" src="~/assets/dataTable/js/dataTables.responsive.min.js"></script>
    <script language="JavaScript" type="text/javascript" src="~/assets/dataTable/js/responsive.bootstrap4.min.js"></script>
    <script language="JavaScript" type="text/javascript" src="~/js/sweetalert2.all.min.js"></script>
    <script src="~/DeveloperJs/ddlSanal.js"></script>

    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <style>
        /* Apply a common font family and size to all headings */
        h1, h2, h3, h4, h5, h6 {
            font-family: Arial, sans-serif !important;
            font-size: 24px !important;
        }

        /* Make the page responsive */
        /* Example of how to make images and videos responsive */
        img, video {
            max-width: 100% !important;
            height: auto !important;
        }

        /* Example of how to make tables responsive */
        .table-responsive {
            overflow-x: auto !important;
        }

        div.dataTables_wrapper div.dataTables_filter {
            text-align: right;
            margin-top: -2rem !important;
        }

        .dgislogo {
            width: 90px;
            height: 60px;
            padding: 0px;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            margin-right: -30px px;
            margin-top: -6px;
            margin-left: 543%;
            height: 60px;
            margin-top: -7px;
        }

        .dgislogo1 {
            width: 90px;
            height: 60px;
            padding: 0px;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            margin-right: -30px px;
            margin-top: -6px;
            margin-left: 543%;
            height: 60px;
            margin-top: -7px;
        }

        .modal-content {
            height: auto; /* Remove fixed height to allow dynamic content */
        }

        .modal-body {
            padding: 20px; /* Add padding for a more spacious look */
        }

        .form-group {
            margin-bottom: 20px; /* Add margin to form groups for spacing */
        }

        /* Customize your form controls */
        .form-control {
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
        }

        /* Style your buttons */
        .btn-primary {
            background-color: #007bff;
            color: #fff;
        }

        .btn-secondary {
            background-color: #6c757d;
            color: #fff;
        }

    </style>

</head>


<div class="wrapper ">

    <header class="top-headers" style="background-color: #333; color: #fff;">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-2 col-md-1">
                    <!-- Left image with max width -->
                    <img src="~/assets/images/dgis_logo.png" class="dgislogo1" alt="Left Image" style="margin-left: -137px;" />
                </div>
                <div class="col-8 col-md-10 text-center">
                    <!-- Centered text -->
                    <p class="headertext" style="text-align:center;margin-left: 261px;">Software Whitelisting Automation System</p>
                </div>
                <div class="col-2 col-md-1 text-end">
                    <!-- Right image with max width -->
                    <img src="~/assets/images/dgis_logo.png" class="dgislogo" alt="Right Image" />
                </div>

            </div>
        </div>
        <div>
            <a href="/Account/Logout">
                <img src="~/assets/images/icons/logout.png" style="width:10%;height:10%;margin-left:-10px" alt="">
            </a>
        </div>
    </header>


    <div class="row">
        <div class="page-content" style="margin-top:3rem;box-shadow:2px 2px 10px black;">
            <div class="row">

                <div class="col-md-8 col-12" style="height: 17rem;overflow: scroll;">
                    <h1 class="policy">WhiteListed Project  </h1>
                    <div class="card-body" style="height:100%;width:100%;overflow-y: scroll;">
                        <div class="row">
                            <table id="WhitelistedTable" class="table table-striped table-bordered" style="overflow: scroll;">
                                <!-- Table header -->

                                <thead>
                                    <tr>
                                        <th colspan="3"></th>
                                        <th colspan="3" class="text-center">Sponsor Contact Details</th>
                                        <th colspan="6"></th>
                                    </tr>
                                    <tr>
                                        <th style="font-size:12px;">S.No</th>
                                        <th style="font-size:12px;">Project Cat</th>
                                        <th style="font-size:12px;">Name of Sw Appl</th>
                                       
                                        <th style="font-size:12px;">Appt</th>
                                        <th style="font-size:12px;">Fmn</th>
                                        <th style="font-size:12px;">Contact No</th>
                                        <th style="width:9rem;font-size:12px;">Dt of ACG Clearane</th>
                                        <th style="width:9rem;font-size:12px;">Cert No& Date</th>
                                        <th style="width:9rem;font-size:12px;">Valid Upto</th>
                                        <th style="width:9rem;font-size:12px;">Remarks</th>
                                    </tr>
                                </thead>
                                <tbody>

                                    @if (WhiteListed != null)
                                    {
                                        int count = 1;
                                        int headerid = 0;
                                        @foreach (var unitx in WhiteListed)
                                        {
                                           @*  if (headerid != @unitx.HeaderID)
                                            {
                                                <tr>

                                                    <td colspan="1" style="font-size:12px;">@unitx.Header</td>
                                                   
                                                    
                                                </tr>
                                         
                                            } *@
                                            <tr>


                                                <td style="font-size:12px;">@count</td>
                                                <td style="font-size:12px;">@unitx.Header</td>

                                                <td style="font-size:12px;">@unitx.ProjName</td>
                                                <td style="font-size:12px;">@unitx.Appt</td>
                                                <td style="font-size:12px;">@unitx.Fmn</td>
                                                <td style="font-size:12px;">@unitx.ContactNo</td>
                                                <td style="font-size:12px;">@unitx.Clearence</td>
                                                <td style="font-size:12px;">@unitx.CertNo @unitx.date</td>
                                                <td style="font-size:12px;">@unitx.ValidUpto</td>
                                                <td style="font-size:12px;">@unitx.Remarks</td>

                                               
                                            </tr>

                                            count = count + 1;
                                            headerid = @unitx.HeaderID;
                                        }
                                    }

                                </tbody>
                            </table>
                        </div>
                        @*</marquee>*@
                    </div>
                </div>

                <div class="col-md-4 col-12" style="height: 17rem; overflow: hidden;">
                    <h1 class="policy2">User Login</h1>
                    <div id="flush-collapseOne" aria-labelledby="flush-headingOne" data-bs-parent="#accordionFlushExample">
                        <div class="card-body">
                            <div class="m-4">

                                @Html.AntiForgeryToken()
                                <div class="row">
                                    <div class="col-md-6 col-12">
                                        <div class="form-group">
                                            <label for="UserId" class="control-label">Domain Id</label>
                                        </div>
                                    </div>
                                    <div class="col-md-6 col-12">
                                        <div class="form-group">
                                            <input type="text" id="UserId" name="UserId" class="form-control" value="@username" readonly required onkeyup="ValInData(this)">
                                            @Html.ValidationMessageFor(model => model.UserId, "", new { @class = "text-danger" })
                                        </div>
                                    </div>

                                    <div class="col-md-6 col-12">
                                        <div class="form-group">
                                            <label for="RoleId" class="control-label">Role</label>
                                        </div>
                                    </div>
                                    <div class="col-md-6 col-12">
                                        <div class="form-group">
                                            <input type="text" id="RoleId" name="RoleId" class="form-control" value="Dte" readonly required onkeyup="ValInData(this)">
                                        </div>
                                    </div>


                                    <div class="col-md-6 col-12">
                                        <div class="form-group">
                                            <button class="btn btn-primary btn-block" style="background-color: @(ViewBag.ProcessButtonColor);
                                                       margin-left: 63%;" id="ProcessId" onclick="ButtonClick()">
                                                @(ButtonText)
                                            </button>
                                        </div>
                                    </div>
                                </div>

                            </div>
                        </div>

                    </div>
                </div>

            </div>

        </div>
    </div>



    <div class="row" style ="margin-bottom:3rem;">
        <div class="col-md-6 hidden" style="box-shadow:1px 1px 3px black;margin-top: 1rem;height: 16rem;overflow: scroll;padding-top:1rem;">
            <h1 class="policy2">New Projects</h1>
            <div class="card-body" style="overflow-y: scroll;">
                <table id="NewProjDetails" class="table table-striped table-bordered" style="overflow: scroll;">
                    <!-- Table header -->
                    <thead>
                        <tr>
                            <th style="font-size:12px;">S.No</th>
                            <th style="font-size:12px;">Project Name</th>
                            <th style="font-size:12px;">PsmId</th>
                            <th style="font-size:12px;">Comment</th>
                            <th style="font-size:12px;">Fwd to</th>
                            <th style="width:9rem;font-size:12px;">Date</th>
                        </tr>
                    </thead>
                    <tbody>
                        @if (newproject != null)
                        {
                            @foreach (var unithol in newproject)
                            {
                                <tr>

                                    <td style="font-size:12px;">@unithol.ProjId</td>
                                    <td style="font-size:12px;">@unithol.ProjName</td>
                                    <td style="font-size:12px;">@unithol.psmid</td>
                                    <td style="font-size:12px;">@unithol.Comment</td>
                                    <td style="font-size:12px;">@unithol.fwdby</td>
                                    <td style="font-size:12px;">@unithol.StrDate</td>
                                </tr>
                            }
                        }

                    </tbody>
                </table>


            </div>

        </div>
        <div class="col-md-6 hidden" style="box-shadow:1px 1px 3px black;margin-top: 1rem;height: 16rem;overflow: scroll;padding-top:1rem;">

            <h1 class="policy2">Proj Held with StakeHolders</h1>

            <div id="card-body" style="height:100%;width:100%;overflow-y: scroll;">

                <table id="HeldTable" class="table table-striped table-bordered" style="overflow-y: scroll;">
                    <!-- Table header -->
                    <thead>
                        <tr>
                            <th style="font-size:12px;">S.No</th>
                            <th style="font-size:12px;">Project Name</th>
                            <th style="font-size:12px;">From</th>
                            <th style="font-size:12px;">Comment</th>
                            <th style="font-size:12px;">Fwd to</th>
                            <th style="width:9rem;font-size:12px;">Date</th>
                        </tr>
                    </thead>
                    <tbody>
                        @if (Holdproj != null)
                        {


                            @foreach (var unitsa in Holdproj)
                            {
                                <tr>

                                    <td style="font-size:12px;">@unitsa.ProjId</td>
                                    <td style="font-size:12px;">@unitsa.ProjName</td>
                                    <td style="font-size:12px;">@unitsa.fwdby</td>
                                    <td style="font-size:12px;">@unitsa.Comment</td>
                                    <td style="font-size:12px;">@unitsa.helwith</td>
                                    <td style="font-size:12px;">@unitsa.StrDate</td>
                                </tr>
                            }
                        }

                    </tbody>
                </table>

            </div>
        </div>
    </div>

    <div class="row" style="margin-bottom:3rem;">
        <div class="col-md-6 hidden" style="box-shadow:1px 1px 3px black;margin-top: -1rem;height: 16rem;overflow: scroll;padding-top:1rem;">
            <h1 class="policy2">Policies</h1>
            <div class="row">
                <table class="table table-striped table-bordered" style="width:100%;">
                    <thead>
                    <th style="font-size:12px;"> IT HW/SW</th>
                    <th style="font-size:12px;"> Project WhiteListing</th>
                    </thead>
                    <tbody>
                    <td>
                            @if (corse != null)
                            {
                                @foreach (var filename in corse)
                                {
                                <a asp-controller="Home"
                           asp-action="WaterMark2" asp-route-id="@filename">@filename</a>
                                <br />
                                }

                            }
                            else
                            {
                        <tr>
                            <td>No recent actions available</td>
                        </tr>

                            }
                    </td>
                    <td>

                            @if (corse != null)
                            {
                                @foreach (var filename in corse)
                                {
                                <a href="@Url.Action("WaterMark2", "Home", new { id = filename })" target="_blank">@filename</a>
                                <br />
                                }

                            }
                            else
                            {
                        <tr>
                            <td>No recent actions available</td>
                        </tr>

                            }
                    </td>
                    </tbody>
                </table>

            </div>

        </div>
        <div class="col-md-6 hidden" style="box-shadow:1px 1px 3px black;margin-top: -1rem;height: 16rem;overflow: scroll;padding-top:1rem;">
            <h1 class="policy2">Under IPA Stage Projects</h1>

            <div id="card-body" style="height:100%;width:100%;overflow-y: scroll;">

                <table id="UnderIPATable" class="table table-striped table-bordered" style="overflow: scroll;">

                    <!-- Table header -->
                    <thead>
                        <tr>
                            <th style="font-size:12px;">S.No</th>
                            <th style="font-size:12px;">Project Name</th>
                            <th style="font-size:12px;">Initited By</th>
                            <th style="font-size:12px;">Aim</th>
                            <th style="font-size:12px;">Remarks</th>
                            <th style="width:9rem;font-size:12px;">Time Limit</th>
                        </tr>
                    </thead>
                    <tbody>
                        @if (stage != null)
                        {

                            @foreach (var unithol in stage)
                            {
                                <tr>

                                    <td style="font-size:12px;">@unithol.ProjId</td>
                                    <td style="font-size:12px;">@unithol.ProjName</td>
                                    <td style="font-size:12px;">@unithol.fwdby</td>
                                    <td style="font-size:12px;">@unithol.Comment</td>
                                    <td style="font-size:12px;">@unithol.helwith</td>
                                    <td style="font-size:12px;">@unithol.TimeLimit</td>

                                </tr>

                            }

                        }

                    </tbody>
                </table>

            </div>
        </div>
    </div>


</div>


<footer class="footers" style="background-color: #333; color: #fff; position: fixed; bottom: 0; width: 100%;">
    <div class="footer-text">
        Copyright &copy; Developed by ASDC, DGIS
    </div>
</footer>

<a href="javaScript:;" class="back-to-top">
    <ion-icon name="arrow-up-outline"></ion-icon>
</a>

<div class="overlay nav-toggle-icon"></div>


<script>
    var flag = "@flag";
    var ButtonText = "@ButtonText";
    var username = "@username";

    function ButtonClick() {
        debugger;
        if (ButtonText === 'Sign In' && flag === 'True') {
            var signInUrl = '/Home/Index';
            window.location.href = signInUrl;
        }
        else {
            if (ButtonText === 'Sign Up') {
                var signUpUrl = '/Identity/Account/Register';
                window.location.href = signUpUrl;
                //window.open(signUpUrl, '_blank');
            }
            else {
                Swal.fire({
                    title: 'Warning!',
                    text: 'Contact ddgit for authorization before signing in.',
                    icon: 'warning',
                    confirmButtonColor: '#ffc107', // Optional: Customize confirm button color
                    confirmButtonText: 'OK' // Optional: Change confirm button text
                });

                return false;
            }

        }
    }



</script>

<script>

    var ip = '@ip';
    $(document).ready(function () {
        var table = $('#NewProjDetails').DataTable({
            lengthChange: false,
            dom: 'lBfrtip',
            buttons: [
                'copy',
                'excel',
                'csv',
                {
                    text: 'PDF',
                    extend: 'pdfHtml5',
                    action: function (e, dt, node, config) {
                        PdfDiv();
                    }
                },
            ],
            searchBuilder: {
                conditions: {
                    num: {
                        'MultipleOf': {
                            conditionName: 'Multiple Of',
                            init: function (that, fn, preDefined = null) {
                                var el = $('<input/>').on('input', function () { fn(that, this) });

                                if (preDefined !== null) {
                                    $(el).val(preDefined[0]);
                                }

                                return el;
                            },
                            inputValue: function (el) {
                                return $(el[0]).val();
                            },
                            isInputValid: function (el, that) {
                                return $(el[0]).val().length !== 0;
                            },
                            search: function (value, comparison) {
                                return value % comparison === 0;
                            }
                        }
                    }
                }
            }
        });
        $('.dataTables_filter input').css('height', '1px');
        
        function PdfDiv() {
            var popupWin = window.open('', '_blank', 'top=100,width=900,height=500,location=no');
            popupWin.document.open();

            var tableStyles = `
                                                                                                  <style type="text/css">
                                                                                                      table {
                                                                                                          width: 100%;
                                                                                                          border-collapse: collapse;
                                                                                                          margin-bottom: 20px;
                                                                                                      }

                                                                                                      .table > thead {
                                                                                                          vertical-align: bottom;
                                                                                                          background-color: red;
                                                                                                      }

                                                                                                      th, td {
                                                                                                          padding: 8px;
                                                                                                          border: 1px solid #ddd;
                                                                                                          text-align: center;
                                                                                                      }

                                                                                                      th {
                                                                                                          background-color: #f2f2f2;
                                                                                                         color: black;
                                                                                                     }

                                                                                                 </style>
                                                                                             `;

            var table = $('#NewProjDetails').DataTable();

            var filteredData = table.rows({ search: 'applied' }).data().toArray();

            var tableHTML = '<table>';

            tableHTML += '<thead>';
            tableHTML += '<tr>';
            table.columns().header().each(function (header) {
                tableHTML += '<th>' + header.innerHTML + '</th>';
            });
            tableHTML += '</tr>';
            tableHTML += '</thead>';

            tableHTML += '<tbody>';
            for (var i = 0; i < filteredData.length; i++) {
                tableHTML += '<tr>';
                for (var j = 0; j < filteredData[i].length; j++) {
                    tableHTML += '<td>' + filteredData[i][j] + '</td>';
                }
                tableHTML += '</tr>';
            }
            tableHTML += '</tbody>';

            tableHTML += '</table>';

            var watermarkText = '@(TempData["ipadd"])';

            popupWin.document.write('<html><head>'
                + tableStyles + '</head><body onload="window.print()">'
                + tableHTML + '<div style="transform: rotate(-45deg);z-index:10000;opacity: 0.3;color: BLACK; position:fixed;top: auto; left: 6%; top: 39%;color: #8e9191;font-size: 80px; font-weight: 500px;display: grid;justify-content: center;align-content: center;">'
                + ip + '</div></body></html>');

            popupWin.document.close();
        }
    });

</script>


<script>

    var ip = '@ip';
    $(document).ready(function () {
        var table = $('#WhitelistedTable').DataTable({
            lengthChange: false,
            dom: 'lBfrtip',
            buttons: [
                'copy',
                'excel',
                'csv',
                {
                    text: 'PDF',
                    extend: 'pdfHtml5',
                    action: function (e, dt, node, config) {
                        PdfDiv();
                    }
                },
            ],
            searchBuilder: {
                conditions: {
                    num: {
                        'MultipleOf': {
                            conditionName: 'Multiple Of',
                            init: function (that, fn, preDefined = null) {
                                var el = $('<input/>').on('input', function () { fn(that, this) });

                                if (preDefined !== null) {
                                    $(el).val(preDefined[0]);
                                }

                                return el;
                            },
                            inputValue: function (el) {
                                return $(el[0]).val();
                            },
                            isInputValid: function (el, that) {
                                return $(el[0]).val().length !== 0;
                            },
                            search: function (value, comparison) {
                                return value % comparison === 0;
                            }
                        }
                    }
                }
            }
        });
        $('.dataTables_filter input').css('height', '1px');


        function PdfDiv() {
            var popupWin = window.open('', '_blank', 'top=100,width=900,height=500,location=no');
            popupWin.document.open();

            var tableStyles = `
                                                                                                                    <style type="text/css">
                                                                                                                    table {
                                                                                                                      width: 100%;
                                                                                                                      border-collapse: collapse;
                                                                                                                      margin-bottom: 20px;
                                                                                                                  }

                                                                                                                  .table > thead {
                                                                                                                      vertical-align: bottom;
                                                                                                                      background-color: red;
                                                                                                                  }

                                                                                                                  th, td {
                                                                                                                      padding: 8px;
                                                                                                                      border: 1px solid #ddd;
                                                                                                                      text-align: center;
                                                                                                                  }

                                                                                                                  th {
                                                                                                                      background-color: #f2f2f2;
                                                                                                                      color: black;
                                                                                                                  }
                                                                                                              </style>
                                                                                                          `;

            var table = $('#WhitelistedTable').DataTable();

            var filteredData = table.rows({ search: 'applied' }).data().toArray();

            var tableHTML = '<table>';

            tableHTML += '<thead>';
            tableHTML += '<tr>';
            table.columns().header().each(function (header) {
                tableHTML += '<th>' + header.innerHTML + '</th>';
            });
            tableHTML += '</tr>';
            tableHTML += '</thead>';

            tableHTML += '<tbody>';
            for (var i = 0; i < filteredData.length; i++) {
                tableHTML += '<tr>';
                for (var j = 0; j < filteredData[i].length; j++) {
                    tableHTML += '<td>' + filteredData[i][j] + '</td>';
                }
                tableHTML += '</tr>';
            }
            tableHTML += '</tbody>';

            tableHTML += '</table>';

            var watermarkText = '@(TempData["ipadd"])';

            popupWin.document.write('<html><head>'
                + tableStyles + '</head><body onload="window.print()">'
                + tableHTML + '<div style="transform: rotate(-45deg);z-index:10000;opacity: 0.3;color: BLACK; position:fixed;top: auto; left: 6%; top: 39%;color: #8e9191;font-size: 80px; font-weight: 500px;display: grid;justify-content: center;align-content: center;">'
                + ip + '</div></body></html>');

            popupWin.document.close();
        }
    });

</script>

<script>
    var ip = '@ip';
    $(document).ready(function () {
        var table = $('#HeldTable').DataTable({
            lengthChange: false,
            dom: 'lBfrtip',
            buttons: [
                'copy',
                'excel',
                'csv',
                {
                    text: 'PDF',
                    extend: 'pdfHtml5',
                    action: function (e, dt, node, config) {
                        PdfDiv();
                    }
                },
            ],
            searchBuilder: {


                conditions: {
                    num: {
                        'MultipleOf': {
                            conditionName: 'Multiple Of',
                            init: function (that, fn, preDefined = null) {
                                var el = $('<input/>').on('input', function () { fn(that, this) });

                                if (preDefined !== null) {
                                    $(el).val(preDefined[0]);
                                }

                                return el;
                            },
                            inputValue: function (el) {
                                return $(el[0]).val();
                            },
                            isInputValid: function (el, that) {
                                return $(el[0]).val().length !== 0;
                            },
                            search: function (value, comparison) {
                                return value % comparison === 0;
                            }


                        }
                    }
                }
            }
        });

        $('.dataTables_filter input').css('height', '1px');
        //var buttonContainer = table.buttons().container();
        //var searchBuilderContainer = table.searchBuilder.container();
        //buttonContainer.insertBefore(table.table().container());
        //searchBuilderContainer.insertBefore(table.table().container());

        function PdfDiv() {
            var popupWin = window.open('', '_blank', 'top=100,width=900,height=500,location=no');
            popupWin.document.open();

            var tableStyles = `
                                                                                          <style type="text/css">
                                                                                          table {
                                                                                            width: 100%;
                                                                                            border-collapse: collapse;
                                                                                            margin-bottom: 20px;
                                                                                        }

                                                                                        .table > thead {
                                                                                            vertical-align: bottom;
                                                                                            background-color: red;
                                                                                        }

                                                                                        th, td {
                                                                                            padding: 8px;
                                                                                            border: 1px solid #ddd;
                                                                                            text-align: center;
                                                                                        }

                                                                                        th {
                                                                                            background-color: #f2f2f2;
                                                                                            color: black;
                                                                                        }
                                                                                    </style>
                                                                                `;

            var table = $('#HeldTable').DataTable();

            var filteredData = table.rows({ search: 'applied' }).data().toArray();

            var tableHTML = '<table>';

            tableHTML += '<thead>';
            tableHTML += '<tr>';
            table.columns().header().each(function (header) {
                tableHTML += '<th>' + header.innerHTML + '</th>';
            });
            tableHTML += '</tr>';
            tableHTML += '</thead>';

            tableHTML += '<tbody>';
            for (var i = 0; i < filteredData.length; i++) {
                tableHTML += '<tr>';
                for (var j = 0; j < filteredData[i].length; j++) {
                    tableHTML += '<td>' + filteredData[i][j] + '</td>';
                }
                tableHTML += '</tr>';
            }
            tableHTML += '</tbody>';

            tableHTML += '</table>';

            var watermarkText = '@(TempData["ipadd"])';

            popupWin.document.write('<html><head>'
                + tableStyles + '</head><body onload="window.print()">'
                + tableHTML + '<div style="transform: rotate(-45deg);z-index:10000;opacity: 0.3;color: BLACK; position:fixed;top: auto; left: 6%; top: 39%;color: #8e9191;font-size: 80px; font-weight: 500px;display: grid;justify-content: center;align-content: center;">'
                + ip + '</div></body></html>');

            popupWin.document.close();
        }
    });



</script>

<script>
    var ip = '@ip';
    $(document).ready(function () {
        var table = $('#UnderIPATable').DataTable({
            lengthChange: false,
            dom: 'lBfrtip',
            buttons: [
                'copy',
                'excel',
                'csv',
                {
                    text: 'PDF',
                    extend: 'pdfHtml5',
                    action: function (e, dt, node, config) {
                        PdfDiv();
                    }
                },
            ],
            searchBuilder: {
                conditions: {
                    num: {
                        'MultipleOf': {
                            conditionName: 'Multiple Of',
                            init: function (that, fn, preDefined = null) {
                                var el = $('<input/>').on('input', function () { fn(that, this) });

                                if (preDefined !== null) {
                                    $(el).val(preDefined[0]);
                                }

                                return el;
                            },
                            inputValue: function (el) {
                                return $(el[0]).val();
                            },
                            isInputValid: function (el, that) {
                                return $(el[0]).val().length !== 0;
                            },
                            search: function (value, comparison) {
                                return value % comparison === 0;
                            }
                        }
                    }
                }
            }
        });
        $('.dataTables_filter input').css('height', '1px');
        //var buttonContainer = table.buttons().container();
        //var searchBuilderContainer = table.searchBuilder.container();
        //buttonContainer.insertBefore(table.table().container());
        //searchBuilderContainer.insertBefore(table.table().container());

        function PdfDiv() {
            var popupWin = window.open('', '_blank', 'top=100,width=900,height=500,location=no');
            popupWin.document.open();

            var tableStyles = `
                                                                                                      <style type="text/css">
                                                                                                      table {
                                                                                                        width: 100%;
                                                                                                        border-collapse: collapse;
                                                                                                        margin-bottom: 20px;
                                                                                                    }

                                                                                                    .table > thead {
                                                                                                        vertical-align: bottom;
                                                                                                        background-color: red;
                                                                                                    }

                                                                                                    th, td {
                                                                                                        padding: 8px;
                                                                                                        border: 1px solid #ddd;
                                                                                                        text-align: center;
                                                                                                    }

                                                                                                    th {
                                                                                                        background-color: #f2f2f2;
                                                                                                        color: black;
                                                                                                    }
                                                                                                </style>
                                                                                            `;

            var table = $('#UnderIPATable').DataTable();

            var filteredData = table.rows({ search: 'applied' }).data().toArray();

            var tableHTML = '<table>';

            tableHTML += '<thead>';
            tableHTML += '<tr>';
            table.columns().header().each(function (header) {
                tableHTML += '<th>' + header.innerHTML + '</th>';
            });
            tableHTML += '</tr>';
            tableHTML += '</thead>';

            tableHTML += '<tbody>';
            for (var i = 0; i < filteredData.length; i++) {
                tableHTML += '<tr>';
                for (var j = 0; j < filteredData[i].length; j++) {
                    tableHTML += '<td>' + filteredData[i][j] + '</td>';
                }
                tableHTML += '</tr>';
            }
            tableHTML += '</tbody>';

            tableHTML += '</table>';

            var watermarkText = '@(TempData["ipadd"])';

            popupWin.document.write('<html><head>'
                + tableStyles + '</head><body onload="window.print()">'
                + tableHTML + '<div style="transform: rotate(-45deg);z-index:10000;opacity: 0.3;color: BLACK; position:fixed;top: auto; left: 6%; top: 39%;color: #8e9191;font-size: 80px; font-weight: 500px;display: grid;justify-content: center;align-content: center;">'
                + ip + '</div></body></html>');

            popupWin.document.close();
        }
    });

</script>


